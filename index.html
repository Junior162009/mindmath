<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<title>MindMath - Web</title>
<style>
  :root{
    --bg:#051126; --card:#072033; --accent:#1e90ff; --accent-2:#7de; --text:#e6eef8;
    --muted:#9fb3c8; --good:#6ee7b7; --bad:#ffb4a2;
    font-family: Inter, Roboto, Arial, sans-serif;
  }
  html,body{height:100%; margin:0; background:var(--bg); color:var(--text);}
  .app{min-height:100vh; display:flex; align-items:center; justify-content:center; padding:16px;}
  .card{width:100%; max-width:560px; background:linear-gradient(180deg,var(--card), #022); border-radius:12px; box-shadow:0 8px 30px rgba(0,0,0,0.6); padding:16px; box-sizing:border-box;}
  h1{margin:6px 0 12px; font-size:28px; text-align:center;}
  .row{display:flex; gap:8px; align-items:center;}
  .col{display:flex; flex-direction:column; gap:8px;}
  button{background:var(--accent); color:#fff; border:none; padding:10px 12px; border-radius:8px; font-size:16px; cursor:pointer;}
  button.ghost{background:transparent; border:1px solid rgba(255,255,255,0.08);}
  select, input[type="text"]{padding:10px; border-radius:8px; border:none; font-size:16px; background:rgba(255,255,255,0.02); color:var(--text);}
  label{font-size:14px; color:var(--muted);}
  .center{display:flex; justify-content:center; align-items:center;}
  .hidden{display:none;}
  .question{font-size:36px; text-align:center; margin:6px 0; color:var(--text); display:flex; gap:12px; align-items:center; justify-content:center;}
  .timebar{height:12px; width:100%; background:rgba(255,255,255,0.06); border-radius:8px; overflow:hidden;}
  .timefill{height:100%; width:100%; background:linear-gradient(90deg,var(--accent), var(--accent-2)); transition:width 0.08s linear;}
  .kbd{display:grid; grid-template-columns:repeat(3,1fr); gap:8px; margin-top:6px;}
  .kbd button{padding:16px; font-size:20px; border-radius:10px; background:rgba(255,255,255,0.06); color:var(--text);}
  .status{display:flex; justify-content:space-between; font-size:14px; color:var(--muted); margin-bottom:6px;}
  .footer-row{display:flex; gap:8px; margin-top:10px; justify-content:space-between;}
  .big{font-size:20px; padding:12px 16px;}
  .feedback{min-height:40px; text-align:center;}
  .feedback .msg{color:#ffd380;}
  .feedback .explain{color:var(--muted); font-size:14px; margin-top:4px;}
  .gameover{font-size:22px; text-align:center; color:#ffd380;}

  /* HUD graphics */
  .hud{display:flex; gap:12px; align-items:center; justify-content:center; margin-bottom:10px;}
  .circle{--size:70px;width:var(--size);height:var(--size);border-radius:50%;display:grid;place-items:center;position:relative;}
  .circle svg{width:78px;height:78px;transform:rotate(-90deg);}
  .circle .num{position:absolute;font-weight:700;font-size:16px;color:var(--text);}
  .op-badge{width:76px;height:40px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:22px;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);box-shadow:0 6px 18px rgba(0,0,0,0.45);}
  .op-badge .op{animation:op-wiggle 2s linear infinite;}
  @keyframes op-wiggle{0%{transform:translateY(0);}50%{transform:translateY(-4px) rotate(-6deg);}100%{transform:translateY(0);}}
  .spark{position:absolute;inset:0;pointer-events:none;opacity:0;transition:opacity 0.18s ease;}
  .spark.show{opacity:1;}
  .spark.correct{background:radial-gradient(circle at 50% 30%, rgba(110,231,183,0.12), transparent 30%);}
  .spark.bad{background:radial-gradient(circle at 50% 30%, rgba(255,180,162,0.12), transparent 30%);}
</style>
</head>
<body>
<div class="app">
  <!-- Pantallas omitidas por brevedad, igual que antes -->
  <!-- ... menú, instrucciones, juego y gameover ... -->

  <!-- GAME -->
  <div class="card hidden" id="gameScreen">
    <div class="status">
      <div id="scoreLabel">Puntaje: 0</div>
      <div id="livesLabel">Vidas: 3</div>
    </div>
    <div class="hud">
      <div class="circle">
        <svg viewBox="0 0 36 36">
          <path d="M18 2.0845 a15.9 15.9 0 0 1 0 31.8 a15.9 15.9 0 0 1 0 -31.8" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="2"/>
          <path id="scoreArc" d="M18 2.0845 a15.9 15.9 0 0 1 0 31.8" fill="none" stroke="url(#grad)" stroke-width="2.6" stroke-linecap="round" stroke-dasharray="0 100"/>
          <defs><linearGradient id="grad"><stop offset="0%" stop-color="var(--accent)"/><stop offset="100%" stop-color="var(--accent-2)"/></linearGradient></defs>
        </svg>
        <div class="num" id="hudScore">0</div>
      </div>
      <div class="op-badge"><span class="op" id="opIcon">×</span><div class="spark" id="sparkArea"></div></div>
    </div>
    <div class="question" id="questionLabel">0 × 0 = ?</div>
    <div class="timebar"><div id="timeFill" class="timefill"></div></div>
    <input id="answerInput" type="text" inputmode="decimal" placeholder="Respuesta">
    <div class="feedback"><div class="msg" id="feedback"></div><div class="explain" id="explain"></div></div>
    <!-- keypad y botones igual que antes -->
  </div>
</div>

<script>
const state={difficulty:'medium',range_max:10,base_time:10,lives:3,score:0,time_remaining:0,max_time:10,num1:0,num2:0,correct:0,op:'*',tolerance:0.01};
const el={questionLabel:document.getElementById('questionLabel'),answerInput:document.getElementById('answerInput'),feedback:document.getElementById('feedback'),explain:document.getElementById('explain'),opIcon:document.getElementById('opIcon'),hudScore:document.getElementById('hudScore'),scoreArc:document.getElementById('scoreArc'),sparkArea:document.getElementById('sparkArea')};

function approxEqual(a,b,t){return Math.abs(a-b)<=t;}
function parseUserAnswer(txt){const c=txt.replace(',', '.').trim();const v=parseFloat(c);return isNaN(v)?null:v;}
function formatAnswer(ans){return Number.isInteger(ans)?ans.toString():(Math.round(ans*100)/100).toFixed(2);}
function explainStep(){let text="";if(state.op==='+')text=`${state.num1} + ${state.num2} = ${state.correct}`;else if(state.op==='-')text=`${state.num1} - ${state.num2} = ${state.correct}`;else if(state.op==='*')text=`${state.num1} × ${state.num2} = ${state.correct}`;else if(state.op==='/')text=`${state.num1} ÷ ${state.num2} = ${formatAnswer(state.correct)}`;else if(state.op==='√')text=`√${state.num1} = ${state.correct}`;return text;}
function submitAnswer(){const txt=el.answerInput.value.trim();el.explain.textContent="";if(!txt){el.feedback.textContent='Ingresa un número';return;}if(state.difficulty==='easy'&&(txt.includes('.')||txt.includes(','))){el.feedback.textContent='Número inválido (solo enteros en Fácil)';return;}const val=parseUserAnswer(txt);if(val===null){el.feedback.textContent='Número inválido';return;}let correct=false;if(state.op==='/'||state.op==='√'){correct=approxEqual(val,state.correct,0.02);}else{correct=approxEqual(val,state.correct,0.0001);}if(correct){el.feedback.textContent='¡Correcto!';}else{el.feedback.textContent=`Incorrecto. Era ${formatAnswer(state.correct)}`;el.explain.textContent=explainStep();}}
</script>
</body>
</html>
